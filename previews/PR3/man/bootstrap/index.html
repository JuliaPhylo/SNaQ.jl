<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bootstrap · SNaQ.jl</title><meta name="title" content="Bootstrap · SNaQ.jl"/><meta property="og:title" content="Bootstrap · SNaQ.jl"/><meta property="twitter:title" content="Bootstrap · SNaQ.jl"/><meta name="description" content="Documentation for SNaQ.jl."/><meta property="og:description" content="Documentation for SNaQ.jl."/><meta property="twitter:description" content="Documentation for SNaQ.jl."/><meta property="og:url" content="https://JuliaPhylo.github.io/SNaQ.jl/man/bootstrap/"/><meta property="twitter:url" content="https://JuliaPhylo.github.io/SNaQ.jl/man/bootstrap/"/><link rel="canonical" href="https://JuliaPhylo.github.io/SNaQ.jl/man/bootstrap/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SNaQ.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SNaQ.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../snaq_est/">Network estimation</a></li><li><a class="tocitem" href="../fixednetworkoptim/">Candidate networks</a></li><li><a class="tocitem" href="../expectedCFs/">Extract expected CFs</a></li><li class="is-active"><a class="tocitem" href>Bootstrap</a><ul class="internal"><li><a class="tocitem" href="#Running-a-bootstrap-analysis"><span>Running a bootstrap analysis</span></a></li><li><a class="tocitem" href="#Support-for-tree-and-hybrid-edges"><span>Support for tree and hybrid edges</span></a></li></ul></li><li><a class="tocitem" href="../parallelcomputation/">Parallel computation</a></li><li><a class="tocitem" href="../multiplealleles/">Multiple alleles</a></li><li><a class="tocitem" href="../error_reporting/">Error reporting</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Bootstrap</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bootstrap</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/SNaQ.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/SNaQ.jl/blob/dev/docs/src/man/bootstrap.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Bootstrap"><a class="docs-heading-anchor" href="#Bootstrap">Bootstrap</a><a id="Bootstrap-1"></a><a class="docs-heading-anchor-permalink" href="#Bootstrap" title="Permalink"></a></h1><blockquote><p>This documentation pertains to SNaQ v1.0 as originally described in <a href="https://doi.org/10.1371/journal.pgen.1005896">Solís-Lemus &amp; Ané (2016)</a></p></blockquote><h2 id="Running-a-bootstrap-analysis"><a class="docs-heading-anchor" href="#Running-a-bootstrap-analysis">Running a bootstrap analysis</a><a id="Running-a-bootstrap-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Running-a-bootstrap-analysis" title="Permalink"></a></h2><p>There are two ways to do a bootstrap analysis.</p><p>First, we can use a table of quartet CFs estimated with credibility intervals, such as if we used BUCKy. The <a href="https://juliaphylo.github.io/PhyloUtilities/">TICR pipeline</a> outputs a CF table with extra columns for credibility intervals. We could then read that table and get bootstrap networks like this, and tweak options as needed:</p><pre><code class="language-julia hljs">using DataFrames, CSV
df = CSV.read(&quot;tableCF_withCI.csv&quot;, DataFrame)
bootnet = bootsnaq(startnetwork, df, hmax=1, filename=&quot;bootstrap&quot;)</code></pre><p>Alternatively, we can use bootstrap gene trees: one file of bootstrap trees per gene. Here, the input is a text file that lists all the bootstrap files (one per gene). We demonstrate this second option here.</p><p>The names of all our bootstrap files are listed in &quot;BSlistfiles&quot;. (ASTRAL can use the same file to do its own bootstrap, see <a href="https://juliaphylo.github.io/PhyloUtilities/notebooks/Gene-Trees-RAxML.html">PhyloUtilities</a>).</p><p>The <code>PhyloNetworks</code> function <a href="https://juliaphylo.github.io/PhyloNetworks.jl/stable/lib/public/#PhyloNetworks.readmultinewick_files-Tuple%7BAbstractString%7D"><code>PhyloNetworks.readmultinewick_files</code></a> can read this list of file names, then read each bootstrap file to get the bootstrap sample for each gene. We can use them to sample input gene trees at random, one per gene, and estimate a network from them. We ask the <a href="../../lib/public/#SNaQ.bootsnaq-Tuple{HybridNetwork, Union{DataFrames.DataFrame, Vector{Vector{HybridNetwork}}}}"><code>bootsnaq</code></a> function to repeat this resampling of bootstrap gene trees several times.</p><pre><code class="language-julia hljs">bootTrees = readmultinewick_files(&quot;BSlistfiles&quot;);
bootnet = bootsnaq(net0, bootTrees, hmax=1, nrep=10, runs=3,
                   filename=&quot;bootsnaq&quot;, seed=4321)</code></pre><p>The bootstrap networks are saved in the <code>boostrap.out</code> file, so they can be read in a new session with <code>bootnet = readmultinewick(&quot;bootsnaq.out&quot;)</code>. To save the bootstrap networks to a different file (perhaps after having re-rooted them with an outgroup), we could do this: <code>writeMultiTopology(bootnet, &quot;bootstrapNets.tre&quot;)</code>.</p><p>The example above creates 10 bootstrap replicates, which is definitely too few, to make the example run faster. We might also increase the number of optimization runs (<code>runs</code>) done for each bootstrap replicate. The following bootstrap was run with the default 10 runs per replicate, and 100 bootstrap replicates, and the 100 bootstrap networks come with the package:</p><pre><code class="language-julia hljs">bootnet = readmultinewick(joinpath(dirname(pathof(SNaQ)), &quot;..&quot;,&quot;examples&quot;,&quot;bootsnaq.out&quot;));
length(bootnet)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">100</code></pre><p>If we used a specified list of quartets on the original data, we should use that same list for the bootstrap analysis through the option <code>quartetfile</code>.</p><h2 id="Support-for-tree-and-hybrid-edges"><a class="docs-heading-anchor" href="#Support-for-tree-and-hybrid-edges">Support for tree and hybrid edges</a><a id="Support-for-tree-and-hybrid-edges-1"></a><a class="docs-heading-anchor-permalink" href="#Support-for-tree-and-hybrid-edges" title="Permalink"></a></h2><p>Now that we have 100 bootstrap networks, we need to summarize what they have in common (highly supported features) and what they don&#39;t (areas of uncertainty).</p><p>We can use PhyloNetworks functions to quantify <a href="https://juliaphylo.github.io/PhyloNetworks.jl/stable/man/network_support/#Network-support">Network support</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../expectedCFs/">« Extract expected CFs</a><a class="docs-footer-nextpage" href="../parallelcomputation/">Parallel computation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Saturday 5 April 2025 19:13">Saturday 5 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
